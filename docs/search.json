[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Did Caddo communities share common trade relationships?",
    "section": "",
    "text": "“The question of questions for mankind—the problem which underlies all others, and is more deeply interesting than any other—is the ascertainment of the place which man occupies in nature, and of his relation to the universe of things.” –H. Thomas Henry Huxley, Man’s Place in Nature"
  },
  {
    "objectID": "index.html#primary-findings",
    "href": "index.html#primary-findings",
    "title": "Did Caddo communities share common trade relationships?",
    "section": "Primary findings",
    "text": "Primary findings\n\n\n\n\n\nLocation of Mounds Plantation and Gahagan Mound, illustrating the geographic extent of the Red River basin (blue) and the ancestral Caddo area (dashed white).\n\n\n\n\n\n\n\n\n\nGahagan bifaces from Caddo burial contexts at Gahagan Mound and Mounds Plantation.\n\n\n\n\n\nColor\nGahagan bifaces were scanned at 600 dpi using an HP ScanJet G4050. Images were subsequently transferred to a transparent background in Photoshop in preparation for analysis using the colordistance package in R (R Core Development Team, 2022; Weller and Westneat 2019). A histogram binning method was used to group similar colors, and pairwise distances between histograms were computed using earth mover’s distance, yielding two distinct raw material color groups (Rubner and Tomasi 2001; Weller and Westneat 2019).\n\n\n\n\n\nColor binning process for a single object; adapted from Weller and Westneat (2019:Figure 2). In a, image of a Gahagan biface with a transparent background; b, 3D scatterplot of 10,000 non-background pixels in RGB color space; c, clusters from histogram displayed in RGB color space; and d, histogram showing the proportion of non-background pixels assigned to each bin.\n\n\n\n\nBifaces were coded as ColorGroup A and ColorGroup B using the output from a neighbor-joining tree, calculated using the color distance matrix. To test whether bifaces differ in color according to ColorGroup assignment, the color distance matrix was exported and joined with the categorical data. Those data were used in a permutational multivariate analysis of variance in the vegan package to evaluate whether biface color differs by raw material color group (R Core Development Team, 2022; Oksanen et al. 2022), where the two raw material color groups were found to differ significantly (permutations = 10,000; Pr(>F) = 9.999e-05).\n\n\n\n\n\nNeighbor-joining tree illustrating color data for the two Gahagan biface ColorGroups; ColorGroup B (left) and ColorGroup A (right).\n\n\n\n\n\n\nGeochemistry\nA Bruker Trace Vi handheld portable X-ray Fluorescence (pXRF) instrument was used to collect elemental data. The instrument was transported to the Williamson Museum and Louisiana State Exhibit Museum and set up in a nose-down configuration, where samples were raised into contact with the pXRF window using a pair of small jacks cushioned with fabric. Due to surface irregularities, the contact between the window and the bifaces was imperfect, resulting in variable count and response rates during data collection.\nData was collected using the following scan parameters: 40kV, 35uA, Ti 25um:Al 300um filter for 180 seconds. Peaks in each spectrum were identified manually in Bruker’s Artax software; once elements were identified, the spectrum was evaluated by the Artax Bayesian statistical program to separate overlapping peaks. The Artax results were exported as net peak areas normalized to the silicon (Si) peak.\nElemental data were subsequently imported to R for a principal components analysis (PCA), followed by a permutational multivariate analysis of variance (perMANOVA), used to assess whether raw material differs between sites.\n\n\n\n\n\nComposite image illustrating the plot of first two principal components by site using a correlation matrix, illustrating 59.32 percent of cumulative shape variation, where gray squares denote Color Group A, and orange triangles denote Color Group B.\n\n\n\n\nThe PCA illustrates 59.97 percent of the variation in the sample among PC1 (42.52 percent) and PC2 (17.45 percent). The perMANOVA demonstrated that elemental values differ significantly by raw material color groups (permutations = 10,000; Pr(>F) = 0.0406).\n\nRaw material color groups differ significantly in geochemistry\n\n\n\n3D geometric morphometrics\nLandmark data were aligned to a global coordinate system (Bookstein et al. 1999; Gunz, Mitteroecker, and Bookstein 2005; Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Bookstein 1986; Rohlf and Slice 1990; Rohlf 1999) in R using the geomorph and RRPP packages (Adams and Collyer 2015; Collyer and Adams 2018; Adams et al. 2017; Adams and Otarola-Castillo 2013; Baken et al. 2021). Procrustes superimposition translates and rotates the coordinate data to allow for comparisons among objects, while also scaling each biface using unit-centroid size—the square root of the sum of squared distances from each landmark to the specimen’s centroid (Chapman 1990; Dryden and Mardia 1998; Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Dryden and Mardia 1993; Kent and Mardia 2001; Rohlf 1999; Slice 2001).\nPrincipal components analysis (Jolliffe 2002) was used to visualize shape variation among the elliptical bifaces, and the scatterplot represents the dispersion of shapes in tangent space (Adams, Rohlf, and Slice 2013; Bookstein 1991; O’Higgins and Jones 1998; Rohlf and Marcus 1993). Shape ranges described by each principal axis are commonly visualized using thin-plate spline warping of a reference image (Klingenberg 2013; Sherratt et al. 2014).\n\n\n\n\n\nPCA summarizing shape variation in Gahagan bifaces from Color Group A (gray squares) and Color Group B (orange triangles).\n\n\n\n\nTo assess whether shape and size differs by ColorGroup, Procrustes ANOVAs (Goodall 1991) were run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003).\n\nGahgan biface shape differs significantly by raw material color group\nGahagan biface size does not differ by raw material color group\nGahagan biface shape is not correlated with the geochemistry of raw material color groups\nGahagan biface size is not correlated with the geochemistry of raw material color groups\n\n\n\n\n\n\nMean shapes summarizing variation in Gahagan bifaces from ColorGroup A and ColorGroup B. In the comparison, black spheres articulate with ColorGroupA, and gray spheres with ColorGroup B."
  },
  {
    "objectID": "index.html#acknowledgments",
    "href": "index.html#acknowledgments",
    "title": "Did Caddo communities share common trade relationships?",
    "section": "Acknowledgments",
    "text": "Acknowledgments\nWe extend our gratitude to the Caddo Nation of Oklahoma, the Caddo Nation Tribal Council, Tribal Chairman, and Tribal Historic Preservation Office for their continued guidance and support of our work, as well as access to NAGPRA and previously repatriated collections. Thanks also to the Williamson Museum and the Louisiana State Exhibit Museum for providing access to the Gahagan bifaces. RZS extend his gratitude to Emma Sherratt, Kersten Bergstrom, Lauren Butaric, Dean C. Adams, and Michael L. Collyer for their constructive criticisms and suggestions throughout the development of this research program."
  },
  {
    "objectID": "index.html#funding",
    "href": "index.html#funding",
    "title": "Did Caddo communities share common trade relationships?",
    "section": "Funding",
    "text": "Funding\nComponents of the analytical workflow were developed and funded by a Preservation Technology and Training grant (P14AP00138) to RZS from the National Center for Preservation Technology and Training, as well as grants to RZS from the Caddo Nation of Oklahoma, National Forests and Grasslands in Texas (15-PA-11081300-033) and the United States Forest Service (20-PA-11081300-074). Additional funding and logistical support was provided by the Heritage Research Center at Stephen F. Austin State University."
  },
  {
    "objectID": "index.html#data-management",
    "href": "index.html#data-management",
    "title": "Did Caddo communities share common trade relationships?",
    "section": "Data management",
    "text": "Data management\nAll data and analysis code associated with this project are openly available through the GitHub repository, which is digitally curated on the Open Science Framework (DOI 10.17605/OSF.IO/3JB94). Additionally, images of all Gahagan bifaces used in this study are openly available to view/download through an open access comparative collection (https://scholarworks.sfasu.edu/ita-gahaganbiface/). The supplementary materials include all analysis data and code used in the study, providing a means for others to reproduce (exactly) those results discussed and expounded upon in this article. The replicable nature of this undertaking provides others with the means to critically assess and evaluate the various analytical components of this study (Gray and Marwick 2019; Peng 2011; Gandrud 2014), which is a necessary requirement for the production of reliable knowledge.\nReproducibility projects in psychology and cancer biology are impacting current research practices across all domains. Examples of reproducible research are becoming more abundant in archaeology (Marwick 2016; Ivanovaite et al. 2020; Selden Jr., Dockall, and Dubied 2020; Selden Jr. et al. 2021; Selden 2022), and the next generation of archaeologists are learning those tools and methods needed to reproduce and/or replicate research results (Marwick et al. 2019). Reproducible and replicable research work flows are often employed at the highest levels of humanities-based inquiries to mitigate concern or doubt regarding proper execution, and is of particular import should the results have—explicitly or implicitly—a major impact on scientific progress (Peels and Bouter 2018)."
  },
  {
    "objectID": "index.html#colophon",
    "href": "index.html#colophon",
    "title": "Did Caddo communities share common trade relationships?",
    "section": "Colophon",
    "text": "Colophon\nThis version of the analysis was generated on 2023-02-17 02:43:51 using the following computational environment and dependencies:\n\n# what R packages and versions were used?\nif (\"devtools\" %in% installed.packages()) devtools::session_info()\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.2.2 (2022-10-31 ucrt)\n os       Windows 10 x64 (build 19045)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  English_United States.utf8\n ctype    English_United States.utf8\n tz       America/Chicago\n date     2023-02-17\n pandoc   2.19.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n cachem        1.0.6   2021-08-19 [1] CRAN (R 4.2.2)\n callr         3.7.3   2022-11-02 [1] CRAN (R 4.2.2)\n cli           3.6.0   2023-01-09 [1] CRAN (R 4.2.2)\n crayon        1.5.2   2022-09-29 [1] CRAN (R 4.2.2)\n devtools      2.4.5   2022-10-11 [1] CRAN (R 4.2.2)\n digest        0.6.31  2022-12-11 [1] CRAN (R 4.2.2)\n ellipsis      0.3.2   2021-04-29 [1] CRAN (R 4.2.2)\n evaluate      0.20    2023-01-17 [1] CRAN (R 4.2.2)\n fastmap       1.1.0   2021-01-25 [1] CRAN (R 4.2.2)\n fs            1.6.1   2023-02-06 [1] CRAN (R 4.2.2)\n glue          1.6.2   2022-02-24 [1] CRAN (R 4.2.2)\n htmltools     0.5.4   2022-12-07 [1] CRAN (R 4.2.2)\n htmlwidgets   1.6.1   2023-01-07 [1] CRAN (R 4.2.2)\n httpuv        1.6.9   2023-02-14 [1] CRAN (R 4.2.2)\n jsonlite      1.8.4   2022-12-06 [1] CRAN (R 4.2.2)\n knitr         1.42    2023-01-25 [1] CRAN (R 4.2.2)\n later         1.3.0   2021-08-18 [1] CRAN (R 4.2.2)\n lifecycle     1.0.3   2022-10-07 [1] CRAN (R 4.2.2)\n magrittr      2.0.3   2022-03-30 [1] CRAN (R 4.2.2)\n memoise       2.0.1   2021-11-26 [1] CRAN (R 4.2.2)\n mime          0.12    2021-09-28 [1] CRAN (R 4.2.0)\n miniUI        0.1.1.1 2018-05-18 [1] CRAN (R 4.2.2)\n pkgbuild      1.4.0   2022-11-27 [1] CRAN (R 4.2.2)\n pkgload       1.3.2   2022-11-16 [1] CRAN (R 4.2.2)\n prettyunits   1.1.1   2020-01-24 [1] CRAN (R 4.2.2)\n processx      3.8.0   2022-10-26 [1] CRAN (R 4.2.2)\n profvis       0.3.7   2020-11-02 [1] CRAN (R 4.2.2)\n promises      1.2.0.1 2021-02-11 [1] CRAN (R 4.2.2)\n ps            1.7.2   2022-10-26 [1] CRAN (R 4.2.2)\n purrr         1.0.1   2023-01-10 [1] CRAN (R 4.2.2)\n R6            2.5.1   2021-08-19 [1] CRAN (R 4.2.2)\n Rcpp          1.0.10  2023-01-22 [1] CRAN (R 4.2.2)\n remotes       2.4.2   2021-11-30 [1] CRAN (R 4.2.2)\n rlang         1.0.6   2022-09-24 [1] CRAN (R 4.2.2)\n rmarkdown     2.20    2023-01-19 [1] CRAN (R 4.2.2)\n rstudioapi    0.14    2022-08-22 [1] CRAN (R 4.2.2)\n sessioninfo   1.2.2   2021-12-06 [1] CRAN (R 4.2.2)\n shiny         1.7.4   2022-12-15 [1] CRAN (R 4.2.2)\n stringi       1.7.12  2023-01-11 [1] CRAN (R 4.2.2)\n stringr       1.5.0   2022-12-02 [1] CRAN (R 4.2.2)\n urlchecker    1.0.1   2021-11-30 [1] CRAN (R 4.2.2)\n usethis       2.1.6   2022-05-25 [1] CRAN (R 4.2.2)\n vctrs         0.5.2   2023-01-23 [1] CRAN (R 4.2.2)\n xfun          0.37    2023-01-31 [1] CRAN (R 4.2.2)\n xtable        1.8-4   2019-04-21 [1] CRAN (R 4.2.2)\n yaml          2.3.7   2023-01-23 [1] CRAN (R 4.2.2)\n\n [1] C:/Users/seldenjrz/AppData/Local/R/win-library/4.2\n [2] C:/Program Files/R/R-4.2.2/library\n\n──────────────────────────────────────────────────────────────────────────────\n\n\nCurrent Git commit details are:\n\n# where can I find this commit? \nif (\"git2r\" %in% installed.packages() & git2r::in_repository(path = \".\")) git2r::repository(here::here())  \n\nLocal:    main D:/github/gahaganmorph.5\nRemote:   main @ origin (https://github.com/seldenlab/gahaganmorph.5)\nHead:     [67f83e9] 2023-02-16: <edit index>"
  },
  {
    "objectID": "c01-color.html",
    "href": "c01-color.html",
    "title": "Raw Material Color Groups",
    "section": "",
    "text": "# compare colors\nlibrary(here)\nlibrary(tidyverse)\nlibrary(colordistance)\nlibrary(recolorize)\nlibrary(vegan)\nlibrary(ape)\n\n# get image paths\nimages <- colordistance::getImagePaths('lagahagan')\n\n# generate color distance matrix ----\ncdm <- imageClusterPipeline(images,\n                            cluster.method = 'hist',\n                            distance.method = 'emd',\n                            lower = FALSE,\n                            upper = FALSE,\n                            hist.bins = 3,\n                            color.space = 'lab',\n                            ref.white = 'D65',\n                            plot.bins = TRUE,\n                            pausing = FALSE\n)\n\n\n  |                                                                            \n  |                                                                      |   0%\n\n\n\n\n\n\n  |                                                                            \n  |==                                                                    |   2%\n\n\n\n\n\n\n  |                                                                            \n  |===                                                                   |   5%\n\n\n\n\n\n\n  |                                                                            \n  |=====                                                                 |   7%\n\n\n\n\n\n\n  |                                                                            \n  |=======                                                               |  10%\n\n\n\n\n\n\n  |                                                                            \n  |=========                                                             |  12%\n\n\n\n\n\n\n  |                                                                            \n  |==========                                                            |  15%\n\n\n\n\n\n\n  |                                                                            \n  |============                                                          |  17%\n\n\n\n\n\n\n  |                                                                            \n  |==============                                                        |  20%\n\n\n\n\n\n\n  |                                                                            \n  |===============                                                       |  22%\n\n\n\n\n\n\n  |                                                                            \n  |=================                                                     |  24%\n\n\n\n\n\n\n  |                                                                            \n  |===================                                                   |  27%\n\n\n\n\n\n\n  |                                                                            \n  |====================                                                  |  29%\n\n\n\n\n\n\n  |                                                                            \n  |======================                                                |  32%\n\n\n\n\n\n\n  |                                                                            \n  |========================                                              |  34%\n\n\n\n\n\n\n  |                                                                            \n  |==========================                                            |  37%\n\n\n\n\n\n\n  |                                                                            \n  |===========================                                           |  39%\n\n\n\n\n\n\n  |                                                                            \n  |=============================                                         |  41%\n\n\n\n\n\n\n  |                                                                            \n  |===============================                                       |  44%\n\n\n\n\n\n\n  |                                                                            \n  |================================                                      |  46%\n\n\n\n\n\n\n  |                                                                            \n  |==================================                                    |  49%\n\n\n\n\n\n\n  |                                                                            \n  |====================================                                  |  51%\n\n\n\n\n\n\n  |                                                                            \n  |======================================                                |  54%\n\n\n\n\n\n\n  |                                                                            \n  |=======================================                               |  56%\n\n\n\n\n\n\n  |                                                                            \n  |=========================================                             |  59%\n\n\n\n\n\n\n  |                                                                            \n  |===========================================                           |  61%\n\n\n\n\n\n\n  |                                                                            \n  |============================================                          |  63%\n\n\n\n\n\n\n  |                                                                            \n  |==============================================                        |  66%\n\n\n\n\n\n\n  |                                                                            \n  |================================================                      |  68%\n\n\n\n\n\n\n  |                                                                            \n  |==================================================                    |  71%\n\n\n\n\n\n\n  |                                                                            \n  |===================================================                   |  73%\n\n\n\n\n\n\n  |                                                                            \n  |=====================================================                 |  76%\n\n\n\n\n\n\n  |                                                                            \n  |=======================================================               |  78%\n\n\n\n\n\n\n  |                                                                            \n  |========================================================              |  80%\n\n\n\n\n\n\n  |                                                                            \n  |==========================================================            |  83%\n\n\n\n\n\n\n  |                                                                            \n  |============================================================          |  85%\n\n\n\n\n\n\n  |                                                                            \n  |=============================================================         |  88%\n\n\n\n\n\n\n  |                                                                            \n  |===============================================================       |  90%\n\n\n\n\n\n\n  |                                                                            \n  |=================================================================     |  93%\n\n\n\n\n\n\n  |                                                                            \n  |===================================================================   |  95%\n\n\n\n\n\n\n  |                                                                            \n  |====================================================================  |  98%\n\n\n\n\n\n\n  |                                                                            \n  |======================================================================| 100%\n\n\n\n\n# replace NAs with 0\ncdm[is.na(cdm)] = 0\n# export color distance matrix\nwrite.csv(cdm, file = \"distance_matrix.csv\")\n\n## preliminaries ----\n# import categorical data\ne.data <- read.csv('catdata.csv',\n                       header = TRUE,\n                       as.is = TRUE)\n\n# import color distance matrix\nc.data <- read.csv('distance_matrix.csv',\n                   header = TRUE,\n                   as.is = TRUE)\n\n# cdm rev sans X + .png (for CIELab)\nc.data2 <- as.data.frame(c.data %>% \n                           select(c(X1BlkThn.png:X666.png)) %>% \n                           rename('1BlkThn' = X1BlkThn.png,\n                                  '1Case2LG' = X1Case2LG.png,\n                                  '1Case2SM' = X1Case2SM.png,\n                                  '1LGGray' = X1LGGray.png,\n                                  '3Ba90' = X3Ba90.png,\n                                  '3Bb1' = X3Bb1.png,\n                                  '3Bb3' = X3Bb3.png,\n                                  '3Bb4' = X3Bb4.png,\n                                  '3Bb5' = X3Bb5.png,\n                                  '3Bb6' = X3Bb6.png,\n                                  '3Bb7' = X3Bb7.png,\n                                  '3Bb8' = X3Bb8.png,\n                                  '489' = X489.png,\n                                  '490' = X490.png,\n                                  '532' = X532.png,\n                                  '533' = X533.png,\n                                  '541' = X541.png,\n                                  '542' = X542.png,\n                                  '543' = X543.png,\n                                  '544' = X544.png,\n                                  '545' = X545.png,\n                                  '546' = X546.png,\n                                  '547' = X547.png,\n                                  '548' = X548.png,\n                                  '549' = X549.png,\n                                  '550' = X550.png,\n                                  '551' = X551.png,\n                                  '569' = X569.png,\n                                  '593' = X593.png,\n                                  '605' = X605.png,\n                                  '606' = X606.png,\n                                  '607' = X607.png,\n                                  '608' = X608.png,\n                                  '609' = X609.png,\n                                  '610' = X610.png,\n                                  '611' = X611.png,\n                                  '612' = X612.png,\n                                  '613' = X613.png,\n                                  '614' = X614.png,\n                                  '622' = X622.png,\n                                  '666' = X666.png)\n)\n\n# column names to ID\nrownames(c.data2) <- colnames(c.data2)"
  },
  {
    "objectID": "c01-color.html#neighbor-joining-tree",
    "href": "c01-color.html#neighbor-joining-tree",
    "title": "Raw Material Color Groups",
    "section": "Neighbor-joining tree",
    "text": "Neighbor-joining tree\n\n# define add_image function ----\nadd_image <- function(obj,\n                      x = NULL,\n                      y = NULL,\n                      width = NULL,\n                      interpolate = TRUE,\n                      angle = 0) {\n  \n  # get current plotting window parameters:\n  usr <- graphics::par()$usr\n  pin <- graphics::par()$pin\n  \n  # image dimensions and scaling factor:\n  imdim <- dim(obj)\n  sf <- imdim[1] / imdim[2]\n  \n  # set the width of the image (relative to x-axis)\n  w <- width / (usr[2] - usr[1]) * pin[1]\n  h <- w * sf\n  hu <- h / pin[2] * (usr[4] - usr[3])\n  \n  # plot the image\n  graphics::rasterImage(image = obj,\n                        xleft = x - (width / 2), xright = x + (width / 2),\n                        ybottom = y - (hu / 2), ytop = y + (hu/2),\n                        interpolate = interpolate,\n                        angle = angle)\n}\n\n## neighbor-joining tree ----\ntree <- nj(as.dist(c.data2))\n# plot tree\nplot(tree,\n     show.tip.label = FALSE,\n     direction = \"upward\")\n\n# get parameters from plotting environment\nlastPP <- get(\"last_plot.phylo\", \n              envir = .PlotPhyloEnv)\n\n# get xy coordinates of tips\nntip <- lastPP$Ntip\n\n# first n values are tips/remaining values are node coordinates\nxy <- data.frame(x = lastPP$xx[1:ntip],\n                 y = lastPP$yy[1:ntip])\n\n# get image names\nimnames <- tools::file_path_sans_ext(basename(images))\n\n# get tip labels\ntipnames <- tree$tip.label\n\n# check that images are in correct order:\nimage_order <- match(tipnames, imnames)\nimages <- images[image_order]\n\n## final plot\npar(mar = rep(0, 4))\nplot(tree, \n     show.tip.label = FALSE, \n     direction = \"upward\")\n\n# parameters from plotting environment\nlastPP <- get(\"last_plot.phylo\", \n              envir = .PlotPhyloEnv)\n\n# xy coordinates of tips\nntip <- lastPP$Ntip\nxy <- data.frame(x = lastPP$xx[1:ntip],\n                 y = lastPP$yy[1:ntip]) \n\nfor (i in 1:length(images)) {\n  add_image(png::readPNG(images[i]),\n            x = xy[i, 1],\n            y = xy[i, 2], \n            width = 0.75)\n}"
  },
  {
    "objectID": "c01-color.html#permutational-manova",
    "href": "c01-color.html#permutational-manova",
    "title": "Raw Material Color Groups",
    "section": "Permutational MANOVA",
    "text": "Permutational MANOVA\n\n##  preliminaries\nc.data3 <- cbind(X = rownames(c.data2), c.data2)\ne.data2 <- e.data %>% \n  select('X','ColorGroup') %>% \n  filter(X != '611')\ngahagan <- left_join(e.data2, c.data3, by = \"X\") # left join by specimen number\ngahagan.dist <- gahagan[,3:43] # color distance matrix\nset.seed(10) # make results reproducible\n\n# model: biface color as a function of Caddo behavioral region\ngahagan.colour <- adonis2(gahagan.dist ~ ColorGroup,\n                          data = gahagan,\n                          permutations = 10000,\n                          method = 'bray')\n\n## does color differ by behavioral region?\ngahagan.colour\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 10000\n\nadonis2(formula = gahagan.dist ~ ColorGroup, data = gahagan, permutations = 10000, method = \"bray\")\n           Df SumOfSqs      R2      F    Pr(>F)    \nColorGroup  1  0.84726 0.42939 28.595 9.999e-05 ***\nResidual   38  1.12593 0.57061                     \nTotal      39  1.97319 1.00000                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "c02-pxrf.html",
    "href": "c02-pxrf.html",
    "title": "RMCG and Geochemistry",
    "section": "",
    "text": "## load packages\nlibrary(here)\n\nhere() starts at D:/github/gahaganmorph.5/supp\n\nlibrary(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2\n──\n\n\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(tidyr)\nlibrary(vegan)\n\nLoading required package: permute\nLoading required package: lattice\nThis is vegan 2.6-4\n\nlibrary(ggpubr)\nlibrary(ggfortify)\nlibrary(cluster)\nlibrary(ggExtra)\nlibrary(ggConvexHull)\nlibrary(wesanderson)\n\n## load pXRF + categorical.data----\npxrf <- read.csv('pxrf.csv',\n                 header = TRUE,\n                 as.is = TRUE)\n\ncat <- read.csv('catdata.csv',\n                header = TRUE,\n                as.is = TRUE)\n\n# join categorical + pxrf data sans 611\ncat.pxrf <- left_join(cat, pxrf, by = \"X\") %>% \n  filter(X != '611')\n\nwrite.csv(cat.pxrf, \n          \"catpxrf.csv\", \n          row.names=FALSE)\n\n#palette\npal <- wes_palette(\"Moonrise2\")"
  },
  {
    "objectID": "c02-pxrf.html#principal-components-analysis",
    "href": "c02-pxrf.html#principal-components-analysis",
    "title": "RMCG and Geochemistry",
    "section": "Principal Components Analysis",
    "text": "Principal Components Analysis\n\n#pca\ndf <- data.frame(cat.pxrf[,c(7:13)])\npch.gps <- c(15,18)[as.factor(cat.pxrf$ColorGroup)]\nColorGroup <- cat.pxrf$ColorGroup\n\n## pca plot using correlation matrix\npca <- autoplot(prcomp(df, scale. = TRUE),\n                data = cat.pxrf,\n                asp = 1,\n                shape = pch.gps,\n                colour = \"ColorGroup\",\n                loadings = TRUE, \n                loadings.colour = 'blue',\n                loadings.label = TRUE,\n                loadings.label.size = 3,\n                frame = TRUE) +\n  geom_convexhull(alpha = 0.1, aes(fill = ColorGroup)) +\n  scale_fill_manual(values = pal) +\n  scale_colour_manual(values = pal)\n\nggMarginal(pca, groupColour = TRUE)\n\n\n\n\n\n# perMANOVA\ngahagan.matrix <- as.matrix(df) # response vars\ngahagan.mat <- sqrt(gahagan.matrix) # sqrt transform\ngahagan.dist <- vegdist(gahagan.mat,\n                        method = 'bray') # dissimilarity matrix\nset.seed(10) # make results reproducible\n\n# model: gahagan cat.pxrf material as a function of ColorGroup\ngahagan <- adonis2(gahagan.dist ~ ColorGroup,\n                   data = cat.pxrf,\n                   permutations = 10000,\n                   method = 'bray')\n\n## does raw material geochemistry differ by ColorGroup?\ngahagan\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 10000\n\nadonis2(formula = gahagan.dist ~ ColorGroup, data = cat.pxrf, permutations = 10000, method = \"bray\")\n           Df SumOfSqs      R2      F Pr(>F)  \nColorGroup  1  0.03465 0.06125 2.4794 0.0406 *\nResidual   38  0.53111 0.93875                \nTotal      39  0.56576 1.00000                \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "c03-morphology.html",
    "href": "c03-morphology.html",
    "title": "RMCG and Morphology",
    "section": "",
    "text": "# load packages\nlibrary(here)\n\nhere() starts at D:/github/gahaganmorph.5/supp\n\nlibrary(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2\n──\n\n\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(geomorph)\n\nLoading required package: RRPP\nLoading required package: rgl\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\nlibrary(wesanderson)\n\n# load shape data----\nsource('readmulti.csv.R')\n\n# read .csv files\nsetwd(\"./data\")\nfilelist <- list.files(pattern = \".csv\")\ncoords <- readmulti.csv(filelist)\nsetwd(\"../\")\n\nqdata <- read.csv(\"qdata.csv\", \n                  header = TRUE, \n                  row.names = 1)\nqdata <- qdata[match(dimnames(coords)[[3]], rownames(qdata)),]"
  },
  {
    "objectID": "c03-morphology.html#generalised-procrustes-analysis",
    "href": "c03-morphology.html#generalised-procrustes-analysis",
    "title": "RMCG and Morphology",
    "section": "Generalised Procrustes Analysis",
    "text": "Generalised Procrustes Analysis\n\n# GPA----\nY.gpa <- gpagen(coords,\n                PrinAxes = TRUE,\n                print.progress = FALSE)\n## plot gpa\nplot(Y.gpa)\n\n# geomorph data frame\ngdf <- geomorph.data.frame(shape = Y.gpa$coords,\n                           size = Y.gpa$Csize,\n                           color = qdata$ColorGroup)"
  },
  {
    "objectID": "c03-morphology.html#principal-components-analysis",
    "href": "c03-morphology.html#principal-components-analysis",
    "title": "RMCG and Morphology",
    "section": "Principal Components Analysis",
    "text": "Principal Components Analysis\n\n# palette\npal <- wes_palette(\"Moonrise2\")\npca <- gm.prcomp(Y.gpa$coords)\nsummary(pca)\n\n\nOrdination type: Principal Component Analysis \nCentering by OLS mean\nOrthogonal projection of OLS residuals\nNumber of observations: 41 \nNumber of vectors 40 \n\nImportance of Components:\n                             Comp1        Comp2        Comp3        Comp4\nEigenvalues            0.003317176 0.0004127174 0.0002703986 0.0001293695\nProportion of Variance 0.727105761 0.0904652645 0.0592698013 0.0283570537\nCumulative Proportion  0.727105761 0.8175710251 0.8768408264 0.9051978801\n                             Comp5        Comp6        Comp7        Comp8\nEigenvalues            0.000118313 0.0000757177 5.623939e-05 3.852516e-05\nProportion of Variance 0.025933523 0.0165968821 1.232735e-02 8.444493e-03\nCumulative Proportion  0.931131403 0.9477282851 9.600556e-01 9.685001e-01\n                              Comp9       Comp10       Comp11       Comp12\nEigenvalues            3.308157e-05 1.660628e-05 1.308046e-05 1.201593e-05\nProportion of Variance 7.251289e-03 3.640000e-03 2.867161e-03 2.633823e-03\nCumulative Proportion  9.757514e-01 9.793914e-01 9.822586e-01 9.848924e-01\n                             Comp13       Comp14       Comp15       Comp16\nEigenvalues            9.106972e-06 8.147741e-06 6.176675e-06 5.951749e-06\nProportion of Variance 1.996196e-03 1.785938e-03 1.353891e-03 1.304589e-03\nCumulative Proportion  9.868886e-01 9.886745e-01 9.900284e-01 9.913330e-01\n                             Comp17       Comp18       Comp19       Comp20\nEigenvalues            5.159287e-06 4.360844e-06 3.734655e-06 3.597074e-06\nProportion of Variance 1.130886e-03 9.558718e-04 8.186148e-04 7.884579e-04\nCumulative Proportion  9.924639e-01 9.934198e-01 9.942384e-01 9.950268e-01\n                             Comp21       Comp22       Comp23       Comp24\nEigenvalues            2.716874e-06 2.392044e-06 2.107326e-06 1.741589e-06\nProportion of Variance 5.955231e-04 5.243223e-04 4.619138e-04 3.817463e-04\nCumulative Proportion  9.956224e-01 9.961467e-01 9.966086e-01 9.969904e-01\n                             Comp25       Comp26       Comp27       Comp28\nEigenvalues            1.644769e-06 1.503050e-06 1.450588e-06 1.221475e-06\nProportion of Variance 3.605238e-04 3.294598e-04 3.179605e-04 2.677403e-04\nCumulative Proportion  9.973509e-01 9.976803e-01 9.979983e-01 9.982660e-01\n                             Comp29       Comp30       Comp31       Comp32\nEigenvalues            1.139999e-06 9.835013e-07 8.953789e-07 8.662951e-07\nProportion of Variance 2.498812e-04 2.155778e-04 1.962619e-04 1.898869e-04\nCumulative Proportion  9.985159e-01 9.987315e-01 9.989278e-01 9.991176e-01\n                             Comp33       Comp34       Comp35       Comp36\nEigenvalues            7.596282e-07 6.401601e-07 5.976925e-07 5.143990e-07\nProportion of Variance 1.665061e-04 1.403194e-04 1.310107e-04 1.127533e-04\nCumulative Proportion  9.992841e-01 9.994245e-01 9.995555e-01 9.996682e-01\n                             Comp37       Comp38       Comp39       Comp40\nEigenvalues            4.573687e-07 4.225718e-07 3.299585e-07 3.036765e-07\nProportion of Variance 1.002526e-04 9.262529e-05 7.232500e-05 6.656414e-05\nCumulative Proportion  9.997685e-01 9.998611e-01 9.999334e-01 1.000000e+00\n\n# set plot parameters to plot by context\npch.gps <- c(15,18)[as.factor(qdata$ColorGroup)]\ncol.gps <- pal[as.factor(qdata$ColorGroup)]\ncol.hull <- c(\"#798E87\",\"#C27D38\")\n\n## plot pca----\npc.plot <- plot(pca, asp = 1,\n                pch = pch.gps,\n                col = col.gps)\nshapeHulls(pc.plot,\n           groups = qdata$ColorGroup,\n           group.cols = col.hull)\n\n\n\n# plot x/y maxima/minima\n# x - minima\nmean.shape <- mshape(Y.gpa$coords)\nplotRefToTarget(pca$shapes$shapes.comp1$min, \n                mean.shape)\n\n\n\n# x - maxima\nplotRefToTarget(pca$shapes$shapes.comp1$max, \n                mean.shape)\n\n\n\n# y - minima\nplotRefToTarget(pca$shapes$shapes.comp2$min, \n                mean.shape)\n\n\n\n# y - maxima\nplotRefToTarget(pca$shapes$shapes.comp2$max, \n                mean.shape)"
  },
  {
    "objectID": "c03-morphology.html#procrustes-anova",
    "href": "c03-morphology.html#procrustes-anova",
    "title": "RMCG and Morphology",
    "section": "Procrustes ANOVA",
    "text": "Procrustes ANOVA\n\n# MODEL: shape as a function of color\nfit.shape <- procD.lm(shape ~ color,\n                      data = gdf,\n                      print.progress = FALSE,\n                      iter = 9999)\n\n# ANOVA: do gahagan biface shapes differ by color?\nanova(fit.shape)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n          Df       SS        MS     Rsq     F      Z Pr(>F)  \ncolor      1 0.018403 0.0184025 0.10084 4.374 1.9564 0.0176 *\nResiduals 39 0.164084 0.0042073 0.89916                      \nTotal     40 0.182487                                        \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCall: procD.lm(f1 = shape ~ color, iter = 9999, data = gdf, print.progress = FALSE)\n\n# MODEL: size as a function of color\nfit.size <- procD.lm(size ~ color,\n                     data = gdf,\n                     print.progress = FALSE,\n                     iter = 9999)\n\n# ANOVA: do gahagan biface sizes differ by color?\nanova(fit.size)\n\n\nAnalysis of Variance, using Residual Randomization\nPermutation procedure: Randomization of null model residuals \nNumber of permutations: 10000 \nEstimation method: Ordinary Least Squares \nSums of Squares and Cross-products: Type I \nEffect sizes (Z) based on F distributions\n\n          Df     SS    MS     Rsq      F       Z Pr(>F)\ncolor      1  15260 15260 0.02621 1.0498 0.54482 0.3095\nResiduals 39 566886 14536 0.97379                      \nTotal     40 582146                                    \n\nCall: procD.lm(f1 = size ~ color, iter = 9999, data = gdf, print.progress = FALSE)"
  },
  {
    "objectID": "c03-morphology.html#b-pls-shape",
    "href": "c03-morphology.html#b-pls-shape",
    "title": "RMCG and Morphology",
    "section": "2B-PLS: Shape",
    "text": "2B-PLS: Shape\n\n# 2B-PLS----\n# elemental data\nelemental <- qdata %>%\n  select(c(Al.K12:Zn.K12))\n\n## shape/elemental----\n# 2B-PLS (elemental) [shape/elemental]\ncor <- two.b.pls(A1 = Y.gpa$coords,\n                 A2 = elemental,\n                 print.progress = FALSE,\n                 iter = 9999)\n\n# is shape correlated with raw material?\nsummary(cor)\n\n\nCall:\ntwo.b.pls(A1 = Y.gpa$coords, A2 = elemental, iter = 9999, print.progress = FALSE) \n\n\n\n\nr-PLS: 0.189\n\nEffect Size (Z): -0.73753\n\nP-value: 0.7941\n\nBased on 10000 random permutations"
  },
  {
    "objectID": "c03-morphology.html#b-pls-size",
    "href": "c03-morphology.html#b-pls-size",
    "title": "RMCG and Morphology",
    "section": "2B-PLS: Size",
    "text": "2B-PLS: Size\n\n# 2B-PLS----\n## size/elemental----\n# 2B-PLS (elemental) [size/elemental]\ncor <- two.b.pls(A1 = Y.gpa$Csize,\n                 A2 = elemental,\n                 print.progress = FALSE,\n                 iter = 9999)\n\n# is size correlated with raw material?\nsummary(cor)\n\n\nCall:\ntwo.b.pls(A1 = Y.gpa$Csize, A2 = elemental, iter = 9999, print.progress = FALSE) \n\n\n\n\nr-PLS: 0.1599\n\nEffect Size (Z): 0.05312\n\nP-value: 0.4618\n\nBased on 10000 random permutations"
  },
  {
    "objectID": "c03-morphology.html#mean-shapes",
    "href": "c03-morphology.html#mean-shapes",
    "title": "RMCG and Morphology",
    "section": "Mean shapes",
    "text": "Mean shapes\n\n# subset landmark coordinates to produce mean shapes for contexts\nnew.coords <- coords.subset(A = Y.gpa$coords,\n                            group = qdata$ColorGroup)\nnames(new.coords)\n\n[1] \"A\" \"B\"\n\n## plot shape means\nmean <- lapply(new.coords, mshape)\nplot(mean$A)\nplot(mean$B)\n\n# comparison plots\nplotRefToTarget(mean$B,\n                mean$A, \n                method = \"points\",\n                mag = 2)\n\nknitr::include_graphics('img/fig5.jpg')"
  }
]