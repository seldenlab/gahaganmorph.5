[
  {
    "objectID": "pxrf.html",
    "href": "pxrf.html",
    "title": "Elemental",
    "section": "",
    "text": "#pca\npch.gps <- c(1:2)[as.factor(raw$Site)]\n\n## pca plot using correlation matrix\npca <- autoplot(prcomp(raw[,c(4:5,8:11)], scale = TRUE),\n                data = raw,\n                asp = 1,\n                shape = pch.gps,\n                colour = \"Site\",\n                variance_percentage = TRUE,\n                loadings = TRUE, \n                loadings.colour = 'blue',\n                loadings.label = TRUE,\n                loadings.label.size = 3,\n                frame = TRUE,\n                frame.type = 't') +\n  scale_fill_manual(values = pal) +\n  scale_colour_manual(values = pal)\n\nggMarginal(pca, groupColour = TRUE)\n\n\n\n\n\n# perMANOVA\ngahagan.matrix <- as.matrix(raw[,c(4:5,8:11)]) # response vars\ngahagan.mat <- sqrt(gahagan.matrix) # sqrt transform\ngahagan.dist <- vegdist(gahagan.mat,\n                        method = 'bray') # dissimilarity matrix\nset.seed(36) # make results reproducible\n\n# model: gahagan geochem as a function of site\ngahagan <- adonis2(gahagan.dist~Site,\n                   data = raw,\n                   permutations = 10000,\n                   method = 'bray')\n\n## does geochemistry differ by site?\ngahagan\n\nPermutation test for adonis under reduced model\nTerms added sequentially (first to last)\nPermutation: free\nNumber of permutations: 10000\n\nadonis2(formula = gahagan.dist ~ Site, data = raw, permutations = 10000, method = \"bray\")\n         Df SumOfSqs      R2      F Pr(>F)  \nSite      1  0.01303 0.07622 3.2177 0.0342 *\nResidual 39  0.15793 0.92378                \nTotal    40  0.17096 1.00000                \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "shape.html",
    "href": "shape.html",
    "title": "Shape + Elemental",
    "section": "",
    "text": "# shape/size ~ raw material?\n\n# load----\n## load packages\nlibrary(here)\n\nhere() starts at D:/github/gahaganmorph.5/supp\n\nlibrary(tidyverse)\n\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n\n\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(geomorph)\n\nLoading required package: RRPP\nLoading required package: rgl\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\nlibrary(wesanderson)\n\n## load pXRF + qual.data----\nraw <- read.csv('pxrf1.csv',\n                header = TRUE,\n                as.is = TRUE)\n\nqual.data <- read.csv(\"qdata.raw.csv\", \n                  header = TRUE,\n                  as.is = TRUE)\n\n# join spreadsheets with qual.data on left\nqdata <- left_join(qual.data, raw,\n                   by = 'specimen')\n\n# output composite csv for GM analysis\nwrite.csv(qdata, \n          file = 'qdata.csv', \n          row.names = FALSE)\n\n## load GM data----\nsource('readmulti.csv.R')\n\n# read .csv files\nsetwd(\"./data\")\nfilelist <- list.files(pattern = \".csv\")\ncoords <- readmulti.csv(filelist)\nsetwd(\"../\")\n\n# read qualitative data\nqdata <- read.csv(\"qdata.csv\", \n                  header = TRUE, \n                  row.names = 1)\nqdata <- qdata[match(dimnames(coords)[[3]], rownames(qdata)),]"
  },
  {
    "objectID": "shape.html#generalised-procrustes-analysis",
    "href": "shape.html#generalised-procrustes-analysis",
    "title": "Shape + Elemental",
    "section": "Generalised Procrustes Analysis",
    "text": "Generalised Procrustes Analysis\n\n# GPA----\nY.gpa <- gpagen(coords,\n                PrinAxes = TRUE,\n                print.progress = FALSE)\n## plot gpa\nplot(Y.gpa)\n\n# geomorph data frame\ngdf <- geomorph.data.frame(shape = Y.gpa$coords,\n                           size = Y.gpa$Csize,\n                           site = qdata$sitename)"
  },
  {
    "objectID": "shape.html#principal-components-analysis",
    "href": "shape.html#principal-components-analysis",
    "title": "Shape + Elemental",
    "section": "Principal Components Analysis",
    "text": "Principal Components Analysis\n\n# PCA----\npca <- gm.prcomp(Y.gpa$coords)\nsummary(pca)\n\n\nOrdination type: Principal Component Analysis \nCentering by OLS mean\nOrthogonal projection of OLS residuals\nNumber of observations: 41 \nNumber of vectors 40 \n\nImportance of Components:\n                             Comp1        Comp2        Comp3        Comp4\nEigenvalues            0.003317176 0.0004127179 0.0002703994 0.0001293694\nProportion of Variance 0.727105774 0.0904653706 0.0592699775 0.0283570286\nCumulative Proportion  0.727105774 0.8175711450 0.8768411225 0.9051981511\n                             Comp5        Comp6        Comp7       Comp8\nEigenvalues            0.000118312 7.571797e-05 5.623922e-05 0.000038525\nProportion of Variance 0.025933303 1.659694e-02 1.232731e-02 0.008444458\nCumulative Proportion  0.931131454 9.477284e-01 9.600557e-01 0.968500166\n                              Comp9       Comp10       Comp11       Comp12\nEigenvalues            3.308153e-05 1.660627e-05 1.308043e-05 1.201593e-05\nProportion of Variance 7.251280e-03 3.639999e-03 2.867154e-03 2.633822e-03\nCumulative Proportion  9.757514e-01 9.793914e-01 9.822586e-01 9.848924e-01\n                             Comp13       Comp14       Comp15       Comp16\nEigenvalues            9.106881e-06 8.147734e-06 6.176662e-06 5.951750e-06\nProportion of Variance 1.996176e-03 1.785936e-03 1.353889e-03 1.304589e-03\nCumulative Proportion  9.868886e-01 9.886745e-01 9.900284e-01 9.913330e-01\n                             Comp17       Comp18       Comp19       Comp20\nEigenvalues            5.159276e-06 4.360862e-06 3.734648e-06 3.597080e-06\nProportion of Variance 1.130883e-03 9.558757e-04 8.186133e-04 7.884591e-04\nCumulative Proportion  9.924639e-01 9.934198e-01 9.942384e-01 9.950268e-01\n                             Comp21       Comp22       Comp23       Comp24\nEigenvalues            2.716881e-06 2.392041e-06 2.107332e-06 1.741592e-06\nProportion of Variance 5.955247e-04 5.243215e-04 4.619149e-04 3.817470e-04\nCumulative Proportion  9.956224e-01 9.961467e-01 9.966086e-01 9.969903e-01\n                             Comp25       Comp26       Comp27       Comp28\nEigenvalues            1.644768e-06 1.503051e-06 1.450587e-06 1.221472e-06\nProportion of Variance 3.605237e-04 3.294602e-04 3.179602e-04 2.677397e-04\nCumulative Proportion  9.973509e-01 9.976803e-01 9.979983e-01 9.982660e-01\n                             Comp29       Comp30       Comp31       Comp32\nEigenvalues            1.140002e-06 9.834997e-07 8.953836e-07 8.662966e-07\nProportion of Variance 2.498818e-04 2.155775e-04 1.962629e-04 1.898872e-04\nCumulative Proportion  9.985159e-01 9.987315e-01 9.989278e-01 9.991176e-01\n                             Comp33       Comp34       Comp35       Comp36\nEigenvalues            7.596271e-07 6.401570e-07 5.976921e-07 5.144043e-07\nProportion of Variance 1.665059e-04 1.403187e-04 1.310107e-04 1.127544e-04\nCumulative Proportion  9.992841e-01 9.994245e-01 9.995555e-01 9.996682e-01\n                             Comp37       Comp38       Comp39       Comp40\nEigenvalues            4.573707e-07 4.225725e-07 3.299571e-07 3.036760e-07\nProportion of Variance 1.002530e-04 9.262546e-05 7.232470e-05 6.656403e-05\nCumulative Proportion  9.997685e-01 9.998611e-01 9.999334e-01 1.000000e+00\n\n# set plot parameters to plot by context\npal <- wes_palette(\"Moonrise2\")\npch.gps <- c(15,17)[as.factor(qdata$sitename)]\ncol.gps <- pal[as.factor(qdata$sitename)]\ncol.hull <- c(\"#C27D38\",\"#798E87\")\n\n## plot pca----\npc.plot <- plot(pca, asp = 1,\n                pch = pch.gps,\n                col = col.gps)\nshapeHulls(pc.plot,\n           groups = qdata$sitename,\n           group.cols = col.hull)\n\n\n\n# plot x/y maxima/minima\n# x - minima\nmean.shape <- mshape(Y.gpa$coords)\nplotRefToTarget(pca$shapes$shapes.comp1$min, \n                mean.shape)\n\n\n\n# x - maxima\nplotRefToTarget(pca$shapes$shapes.comp1$max, \n                mean.shape)\n\n\n\n# y - minima\nplotRefToTarget(pca$shapes$shapes.comp2$min, \n                mean.shape)\n\n\n\n# y - maxima\nplotRefToTarget(pca$shapes$shapes.comp2$max, \n                mean.shape)"
  },
  {
    "objectID": "shape.html#b-pls",
    "href": "shape.html#b-pls",
    "title": "Shape + Elemental",
    "section": "2B-PLS",
    "text": "2B-PLS\n\n# 2B-PLS----\n# geochem data w/o Ca/Fe \ngeochem <- qdata %>%\n  select(Al.K12:Ba.L1, Ni.K12:Zn.K12)\n\n## shape/log.geochem----\n# 2B-PLS (geochem.2) [shape/geochem]\ncor <- two.b.pls(A1 = Y.gpa$coords,\n                 A2 = geochem,\n                 print.progress = FALSE,\n                 iter = 9999)\nsummary(cor)\n\n\nCall:\ntwo.b.pls(A1 = Y.gpa$coords, A2 = geochem, iter = 9999, print.progress = FALSE) \n\n\n\n\nr-PLS: 0.5438\n\nEffect Size (Z): 2.58394\n\nP-value: 0.0032\n\nBased on 10000 random permutations\n\n## plot PLS\nplot(cor)"
  },
  {
    "objectID": "shape.html#b-pls-shape",
    "href": "shape.html#b-pls-shape",
    "title": "Shape + Elemental",
    "section": "2B-PLS: Shape",
    "text": "2B-PLS: Shape\n\n# 2B-PLS----\n# geochem data w/o Ca/Fe \ngeochem <- qdata %>%\n  select(Al.K12:Ba.L1, Ni.K12:Zn.K12)\n\n## shape/log.geochem----\n# 2B-PLS (geochem) [shape/geochem]\ncor <- two.b.pls(A1 = Y.gpa$coords,\n                 A2 = geochem,\n                 print.progress = FALSE,\n                 iter = 9999)\n\n# is shape correlated with raw material?\nsummary(cor)\n\n\nCall:\ntwo.b.pls(A1 = Y.gpa$coords, A2 = geochem, iter = 9999, print.progress = FALSE) \n\n\n\n\nr-PLS: 0.5438\n\nEffect Size (Z): 2.58394\n\nP-value: 0.0032\n\nBased on 10000 random permutations\n\n## plot PLS\nplot(cor)"
  },
  {
    "objectID": "shape.html#b-pls-size",
    "href": "shape.html#b-pls-size",
    "title": "Shape + Elemental",
    "section": "2B-PLS: Size",
    "text": "2B-PLS: Size\n\n# 2B-PLS----\n# geochem data w/o Ca/Fe\ngeochem <- qdata %>%\n  select(Al.K12:Ba.L1, Ni.K12:Zn.K12)\n\n## size/log.geochem----\n# 2B-PLS (geochem) [size/geochem]\ncor <- two.b.pls(A1 = Y.gpa$Csize,\n                 A2 = geochem,\n                 print.progress = FALSE,\n                 iter = 9999)\n\n# is size correlated with raw material?\nsummary(cor)\n\n\nCall:\ntwo.b.pls(A1 = Y.gpa$Csize, A2 = geochem, iter = 9999, print.progress = FALSE) \n\n\n\n\nr-PLS: 0.3053\n\nEffect Size (Z): 0.94206\n\nP-value: 0.1765\n\nBased on 10000 random permutations\n\n## plot PLS\nplot(cor)"
  }
]